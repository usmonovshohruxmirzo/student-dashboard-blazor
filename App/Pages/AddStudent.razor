@page "/add-student"
@using NET9.BlazorWebAppServerGlobal.Models
@using NET9.BlazorWebAppServerGlobal.Services
@inject StudentService StudentService
@inject NavigationManager NavigationManager

<PageTitle>Add Student</PageTitle>

<h1 class="page-title">Add New Student</h1>

<form class="student-form" @onsubmit="HandleAddStudent">
    <div class="form-group">
        <label>Full Name</label>
        <input type="text" @bind="newStudent.FullName" placeholder="Enter student name" />
    </div>

    <div class="form-group">
        <label>Gender</label>
        <select @bind="newStudent.Gender">
            <option disabled selected>Select gender</option>
            <option>Male</option>
            <option>Female</option>
            <option>Other</option>
        </select>
    </div>

    <div class="form-group">
        <label>Date of Birth</label>
        <input type="date" @bind="newStudent.DateOfBirth" />
    </div>

    <div class="form-group">
        <label>GPA</label>
        <input type="number" min="0" max="4" step="0.01" @bind="newStudent.Gpa" />
    </div>

    <div class="form-group">
        <label>Subjects (comma-separated)</label>
        <input type="text" placeholder="Math, English" @bind="subjectsInput" />
    </div>

    <div class="form-actions">
        <button type="submit">Add Student</button>
        <button type="reset" class="cancel-btn">Cancel</button>
    </div>
</form>

@code {
    private Student newStudent = new Student();
    private string subjectsInput = string.Empty;

    private void HandleAddStudent()
    {
        newStudent.Subjects = subjectsInput
            .Split(',', StringSplitOptions.RemoveEmptyEntries)
            .Select(s => s.Trim())
            .ToList();

        StudentService.AddStudent(newStudent);

        newStudent = new Student();
        subjectsInput = string.Empty;

        NavigationManager.NavigateTo("/students");
    }
}
